# Тестовое задание для отбора на Летнюю ИТ-школу КРОК по разработке

## Условие задания
Однажды теплым летним вечером вас посетила идея разработать свое расширение для браузера для построения ссылочного графа. Что это означает на практике — ваше расширение активируется на какой-либо web-странице сайта, определяет список уникальных внешних ссылок, после чего повторяет алгоритм для каждой ссылки. Максимальная глубина поиска, визуализация собранных данных и прочие вопросы вы сочли вторичными, а начать решено было с малого — с обходчика страниц, который бы находил уникальные ссылки.

В процессе проектирования вы решили немного упростить ваш mvp и в итоге поставили себе задачу следующим образом: реализовать поиск всех уникальных ресурсов (доменов) в рамках страницы, на которые есть ссылки. При этом, формулируя задачу, вы сделали следующие допущения:
- Доменом считается запись вида example.com;
- Поддомен, например, sub.example.com,  считается отдельным ресурсом;
- Протокол (при наличии) не имеет значения.

Требования к реализации:
1. Реализация должна содержать, как минимум, одну процедуру (функцию/метод), отвечающую за поиск уникальных ресурсов, и должна быть описана в readme.md в соответствии с чек-листом;
2. В качестве входных данных программа использует реальный html-файл (page.html)	, считав который, начинает выполнять поиск;
3. Процедура (функция/метод) поиска должна возвращать строку в формате json следующего формата:
   - {«sites»: [«mail.ru», «rbc.ru», «ria.ru»]}
4. Найденные в соответствии с условием задачи домены должны выводиться в нижнем регистре без указания протокола и «www» в алфавитном порядке.

## Автор решения
Бурдельная Вероника Валентиновна

## Описание реализации
Создаётся пустое множество, в которое будут добавляться ссылки по мере обхода html-документа.

Для парсинга тэгов переданного html-документа используется _BeautifulSoup_. С его помощью обходятся все тэги _a_, в них рассматривается атрибут _href_, который хранит гиперссылки.

Далее каждая гиперссылка проверяется на валидность функцией __is_valid_url__, в которой ссылки являются валидными, если:
- это непустой объект (не None);
- длина строки превышает 2 (разумный минимум для доменного имени);
- соответствует формату ссылки, проверяемому регуляным выражением, то есть проверяется, что это нечто, что не содержит пробелов, может быть разделено точками, а в конце имеет ./домен верхнего уровня/.

Ссылки, которые были признаны валидными на предыдущем шаге, форматируются функцией __format_url__. Форматирование происходит следующим образом:
- избавление от протокола и www при наличии с помощью регулярного выражения;
- убираются путь, якорь и тд. из ссылки с помощью разбиения по символу _/_;
- ссылка приводится в нижний регистр.

Затем проверяется, что ссылка всё ещё осталась валидной, и если так, то добавляется в множество с ссылками.

Обработка html-файла завершена. Найденные ссылки передаются в функцию __prepare_output__, где они сортируются в алфавитном порядке и выводятся в терминал в указанном в задании виде.


## Инструкция по сборке и запуску решения

1. Настройка виртуальной среды

Создать виртуальную среду:

```shell
python3 -m venv venv
```

Активировать её:

```shell
source venv/bin/activate
```

Установить необходимые зависимости:

```shell
python3 -m pip install -r requirements.txt
```

2. Запуск скрипта:
(запуск из корня проекта)

```shell
python3 src/url_parser.py xxx.html
```
Здесь 'xxx.html' - файл для тестирования. 

